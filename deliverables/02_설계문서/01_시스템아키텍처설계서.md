# 시스템 아키텍처 설계서

**프로젝트명**: 푸름대학교 학생성장지원센터 CHAMP (SCMS3)
**작성일**: 2025-11-18
**버전**: 1.0
**작성자**: 개발팀

---

## 1. 문서 개요

### 1.1 목적
본 문서는 푸름대학교 학생성장지원센터 CHAMP 시스템의 전체 아키텍처를 상세히 기술하여, 시스템의 구조, 구성 요소, 기술 스택 및 설계 원칙을 명확히 제시합니다.

### 1.2 범위
- 시스템 전체 구조 및 레이어 설계
- 주요 구성 요소 및 모듈
- 기술 스택 및 프레임워크
- 보안 아키텍처
- 데이터 흐름 및 통신 방식

### 1.3 대상 독자
- 시스템 개발자
- 시스템 아키텍트
- 프로젝트 관리자
- 유지보수 담당자

---

## 2. 시스템 개요

### 2.1 시스템 목적
푸름대학교 학생성장지원센터 CHAMP는 학생들의 핵심역량을 관리하고, 비교과 프로그램을 운영하며, 마일리지를 통한 학생 활동을 장려하는 통합 학생 성장 지원 시스템입니다.

### 2.2 주요 기능
1. **인증 및 권한 관리**: 학생/관리자/상담사 로그인 및 권한 관리
2. **비교과 프로그램 관리**: 프로그램 등록, 신청, 승인, 평가
3. **역량 진단 및 관리**: 학생 역량 진단, 분석, 프로그램 추천
4. **마일리지 시스템**: 활동 참여에 따른 마일리지 적립 및 관리
5. **상담 관리**: 상담 신청, 일정 관리, 이력 조회
6. **포트폴리오 관리**: 학생 활동 기록 및 포트폴리오 작성
7. **설문조사**: 만족도 조사 및 피드백 수집
8. **외부취업가점**: 외부 자격증 및 취업 활동 가점 관리
9. **알림 시스템**: 실시간 알림 및 공지사항

---

## 3. 시스템 아키텍처

### 3.1 전체 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                          Client Layer                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │   Web Browser │  │    Mobile    │  │    Tablet    │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└─────────────────────────────────────────────────────────────────┘
                              ▼ HTTP/HTTPS
┌─────────────────────────────────────────────────────────────────┐
│                      Presentation Layer                          │
│  ┌──────────────────────────────────────────────────────┐       │
│  │            Thymeleaf Template Engine                  │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │       │
│  │  │   HTML5     │  │    CSS3     │  │ JavaScript  │  │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  │       │
│  └──────────────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                       Controller Layer                           │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              Spring MVC Controllers                       │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │    Auth     │  │   Program   │  │  Mileage    │      │   │
│  │  │ Controller  │  │ Controller  │  │ Controller  │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ Counseling  │  │  Portfolio  │  │   Survey    │      │   │
│  │  │ Controller  │  │ Controller  │  │ Controller  │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Service Layer                             │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              Business Logic Services                      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │    User     │  │   Program   │  │  Mileage    │      │   │
│  │  │  Service    │  │  Service    │  │  Service    │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │Consultation │  │  Portfolio  │  │   Survey    │      │   │
│  │  │  Service    │  │  Service    │  │  Service    │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │Notification │  │Competency   │  │ External    │      │   │
│  │  │  Service    │  │ Assessment  │  │ Employment  │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     Repository Layer                             │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │           Spring Data JPA Repositories                    │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │    User     │  │   Program   │  │  Mileage    │      │   │
│  │  │ Repository  │  │ Repository  │  │ Repository  │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                       Data Layer                                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                    MySQL 8.0 Database                     │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │    users    │  │  programs   │  │  mileage    │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 아키텍처 패턴

#### 3.2.1 계층형 아키텍처 (Layered Architecture)
시스템은 다음과 같은 계층으로 구성됩니다:

1. **Presentation Layer (표현 계층)**
   - 사용자 인터페이스 담당
   - Thymeleaf 템플릿 엔진 사용
   - HTML5, CSS3, JavaScript로 구현

2. **Controller Layer (컨트롤러 계층)**
   - HTTP 요청/응답 처리
   - Spring MVC 패턴 적용
   - 입력 검증 및 라우팅

3. **Service Layer (서비스 계층)**
   - 비즈니스 로직 구현
   - 트랜잭션 관리
   - 도메인 로직 캡슐화

4. **Repository Layer (저장소 계층)**
   - 데이터 접근 추상화
   - Spring Data JPA 사용
   - CRUD 및 쿼리 메서드

5. **Data Layer (데이터 계층)**
   - 영속성 데이터 저장
   - MySQL 데이터베이스
   - 관계형 데이터 모델

#### 3.2.2 MVC 패턴 (Model-View-Controller)
- **Model**: Entity, DTO 클래스
- **View**: Thymeleaf 템플릿
- **Controller**: Spring MVC Controllers

#### 3.2.3 Repository 패턴
- Spring Data JPA를 활용한 데이터 접근 계층 추상화
- 인터페이스 기반 Repository 정의
- 자동 쿼리 생성 및 Custom Query 지원

#### 3.2.4 DTO 패턴 (Data Transfer Object)
- 계층 간 데이터 전송을 위한 객체
- Request DTO: 클라이언트 → 서버
- Response DTO: 서버 → 클라이언트
- Entity와 분리하여 관심사 분리

---

## 4. 기술 스택

### 4.1 Backend

| 구분 | 기술 | 버전 | 용도 |
|------|------|------|------|
| 언어 | Java | 17 | 백엔드 개발 언어 |
| 프레임워크 | Spring Boot | 3.x | 애플리케이션 프레임워크 |
| 보안 | Spring Security | 6.x | 인증/인가 |
| ORM | Spring Data JPA | 3.x | 데이터 접근 계층 |
| 데이터베이스 | MySQL | 8.0 | 관계형 데이터베이스 |
| 빌드 도구 | Gradle | 8.x | 프로젝트 빌드 |
| 템플릿 엔진 | Thymeleaf | 3.x | 서버 사이드 렌더링 |

### 4.2 Frontend

| 구분 | 기술 | 버전 | 용도 |
|------|------|------|------|
| 마크업 | HTML5 | - | 웹 페이지 구조 |
| 스타일링 | CSS3 | - | 웹 페이지 디자인 |
| 스크립트 | JavaScript | ES6+ | 클라이언트 로직 |
| 템플릿 | Thymeleaf | 3.x | 동적 HTML 생성 |
| 레이아웃 | Thymeleaf Layout Dialect | 3.x | 공통 레이아웃 관리 |

### 4.3 Infrastructure

| 구분 | 기술 | 용도 |
|------|------|------|
| 컨테이너 | Docker | 개발 환경 구성 |
| 데이터베이스 | MySQL 8.0 | 데이터 저장소 |
| 버전 관리 | Git | 소스 코드 관리 |
| CI/CD | GitHub Actions | 자동화 빌드/배포 |

---

## 5. 주요 구성 요소

### 5.1 인증 및 권한 관리

#### 5.1.1 구조
```
AuthController
    ↓
UserService
    ↓
Spring Security
    ↓
SecurityContext + HttpSession
```

#### 5.1.2 주요 컴포넌트
- **SecurityConfig**: Spring Security 설정
- **CustomUserDetailsService**: 사용자 인증 정보 로드
- **BCryptPasswordEncoder**: 비밀번호 암호화
- **LoginSuccessHandler**: 로그인 성공 핸들러
- **LoginFailureHandler**: 로그인 실패 핸들러

#### 5.1.3 인증 흐름
```
1. 사용자가 학번/비밀번호 입력
   ↓
2. AuthController가 요청 수신
   ↓
3. UserService가 사용자 정보 검증
   ↓
4. Spring Security가 인증 처리
   ↓
5. SecurityContext에 인증 정보 저장
   ↓
6. HttpSession에 세션 생성
   ↓
7. 클라이언트에 세션 쿠키 전송
```

### 5.2 프로그램 관리

#### 5.2.1 구조
```
ProgramAdminController / ProgramApplicationController
    ↓
ProgramService / ProgramApplicationService
    ↓
ProgramRepository / ProgramApplicationRepository
    ↓
Program / ProgramApplication Entity
```

#### 5.2.2 주요 기능
- 프로그램 CRUD (생성, 조회, 수정, 삭제)
- 프로그램 신청/취소
- 신청 승인/거부 (관리자)
- 프로그램 검색 및 필터링
- 프로그램 평가 및 리뷰

### 5.3 마일리지 시스템

#### 5.3.1 구조
```
MileageController / MileageAdminController
    ↓
MileageService
    ↓
MileageRepository
    ↓
Mileage Entity
```

#### 5.3.2 마일리지 적립 로직
```
프로그램 참여 완료
    ↓
MileageService.addMileage()
    ↓
마일리지 적립 내역 생성
    ↓
사용자 총 마일리지 업데이트
```

### 5.4 역량 진단 시스템

#### 5.4.1 구조
```
SurveyPageController / ProgramRecommendationController
    ↓
CompetencyAssessmentService / ProgramRecommendationService
    ↓
SurveyRepository / CompetencyRepository
    ↓
Survey / CompetencyAssessment Entity
```

#### 5.4.2 역량 진단 흐름
```
1. 학생이 역량 진단 설문 응답
   ↓
2. 응답 데이터 저장
   ↓
3. 역량 점수 계산 (평균, 가중치)
   ↓
4. 역량별 점수 분석
   ↓
5. 부족한 역량 파악
   ↓
6. 추천 프로그램 목록 생성
```

### 5.5 상담 관리

#### 5.5.1 구조
```
CounselingPageController / ConsultationController
    ↓
ConsultationService / CounselorService
    ↓
ConsultationRepository / CounselorRepository
    ↓
Consultation / Counselor Entity
```

#### 5.5.2 상담 프로세스
```
1. 학생이 상담 신청
   ↓
2. 상담사가 신청 확인
   ↓
3. 상담 일정 조율
   ↓
4. 상담 진행
   ↓
5. 상담 기록 작성
   ↓
6. 상담 완료 처리
```

### 5.6 포트폴리오 관리

#### 5.6.1 구조
```
PortfolioPageController / PortfolioItemController
    ↓
PortfolioService / PortfolioItemService / PortfolioFileService
    ↓
PortfolioRepository / PortfolioItemRepository
    ↓
Portfolio / PortfolioItem / PortfolioFile Entity
```

### 5.7 알림 시스템

#### 5.7.1 구조
```
NotificationController
    ↓
NotificationService
    ↓
NotificationRepository
    ↓
Notification Entity
```

#### 5.7.2 알림 유형
- 프로그램 신청 승인/거부
- 상담 일정 확정
- 마일리지 적립
- 공지사항
- 시스템 알림

---

## 6. 보안 아키텍처

### 6.1 인증 방식
- **세션 기반 인증**: HttpSession + Spring Security
- **BCrypt 암호화**: 비밀번호 단방향 암호화
- **Role 기반 접근 제어**: STUDENT, COUNSELOR, ADMIN

### 6.2 보안 정책

#### 6.2.1 비밀번호 정책
- 최소 8자 이상
- 영문, 숫자, 특수문자 조합 (선택)
- BCrypt 알고리즘 사용 (강도: 10)

#### 6.2.2 세션 관리
- 세션 타임아웃: 30분
- 동시 로그인 제한: 1개 세션
- 로그아웃 시 세션 완전 삭제

#### 6.2.3 CSRF 보호
- Spring Security CSRF 토큰 사용
- 모든 POST/PUT/DELETE 요청에 토큰 검증

#### 6.2.4 XSS 방어
- Thymeleaf 자동 이스케이프
- 사용자 입력 검증 및 필터링

#### 6.2.5 SQL Injection 방어
- JPA PreparedStatement 사용
- 파라미터 바인딩

### 6.3 접근 제어

| URL 패턴 | 접근 권한 |
|----------|----------|
| `/`, `/login`, `/password/**` | 공개 |
| `/api/programs/list`, `/programs/**` | 인증 필요 |
| `/api/applications/**` | STUDENT |
| `/api/admin/**` | ADMIN |
| `/api/counseling/**` | COUNSELOR, ADMIN |
| `/api/mileage/admin/**` | ADMIN |

---

## 7. 데이터 흐름

### 7.1 일반적인 요청 흐름

```
Client (Browser)
    ↓ HTTP Request
Controller
    ↓ DTO
Service (Business Logic)
    ↓ Entity
Repository (Data Access)
    ↓ SQL
Database
    ↓ Result
Repository
    ↓ Entity
Service
    ↓ DTO
Controller
    ↓ HTTP Response
Client (Browser)
```

### 7.2 파일 업로드 흐름

```
Client
    ↓ MultipartFile
Controller (ProgramFileController / PortfolioFileController)
    ↓
Service (ProgramFileService / PortfolioFileService)
    ↓ 파일 검증 (확장자, 크기)
    ↓ 파일 저장 (/uploads/{type}/{id}/)
    ↓ 파일 메타데이터 저장 (DB)
Repository
    ↓
Database
```

### 7.3 알림 발송 흐름

```
이벤트 발생 (예: 신청 승인)
    ↓
Service
    ↓
NotificationService.createNotification()
    ↓ 알림 엔티티 생성
NotificationRepository.save()
    ↓
Database
    ↓
클라이언트 요청 시 알림 목록 반환
```

---

## 8. 성능 고려사항

### 8.1 데이터베이스 최적화
- **인덱스 설정**: 자주 검색되는 컬럼 (student_num, email, program_id)
- **쿼리 최적화**: N+1 문제 해결 (fetch join, EntityGraph)
- **커넥션 풀**: HikariCP 사용 (기본 설정)

### 8.2 페이징 처리
- Spring Data JPA Pageable 사용
- 대량 데이터 조회 시 페이징 필수
- 기본 페이지 크기: 10개

### 8.3 파일 처리
- 파일 크기 제한: 10MB
- 허용 확장자: jpg, jpeg, png, pdf, doc, docx, xlsx
- 저장 위치: `/uploads/{type}/{id}/`

---

## 9. 확장성 고려사항

### 9.1 수평적 확장 (Horizontal Scaling)
- 무상태(Stateless) 설계
- 세션 저장소 분리 (향후 Redis 도입 검토)
- 로드 밸런서 적용 가능

### 9.2 수직적 확장 (Vertical Scaling)
- JVM 힙 메모리 조정
- 데이터베이스 리소스 증설
- 커넥션 풀 크기 조정

### 9.3 마이크로서비스 전환 가능성
현재는 모놀리식 아키텍처이지만, 향후 다음과 같은 마이크로서비스로 분리 가능:
- **User Service**: 사용자 관리
- **Program Service**: 프로그램 관리
- **Mileage Service**: 마일리지 관리
- **Counseling Service**: 상담 관리
- **Notification Service**: 알림 관리

---

## 10. 모니터링 및 로깅

### 10.1 로깅
- **프레임워크**: SLF4J + Logback
- **로그 레벨**: DEBUG (개발), INFO (운영)
- **로그 출력**: 콘솔, 파일 (logs/spring-boot.log)

### 10.2 모니터링 (향후 도입 검토)
- Spring Boot Actuator
- Prometheus + Grafana
- 애플리케이션 메트릭 수집

---

## 11. 배포 아키텍처

### 11.1 개발 환경
```
Developer PC
    ↓
Docker Compose (MySQL)
    ↓
Spring Boot Embedded Tomcat (localhost:8080)
```

### 11.2 운영 환경 (계획)
```
Client
    ↓ HTTPS
Load Balancer (Nginx)
    ↓
Application Server (Spring Boot) x N
    ↓
Database (MySQL Master)
    ↓
Database (MySQL Slave) - Read Replica
```

---

## 12. 디렉토리 구조

```
SCMS3/
├── src/
│   ├── main/
│   │   ├── java/com/scms/app/
│   │   │   ├── config/              # 설정 클래스
│   │   │   │   ├── SecurityConfig.java
│   │   │   │   ├── WebConfig.java
│   │   │   │   └── DataLoader.java
│   │   │   ├── controller/          # 컨트롤러
│   │   │   │   ├── AuthController.java
│   │   │   │   ├── ProgramAdminController.java
│   │   │   │   ├── MileageController.java
│   │   │   │   └── ...
│   │   │   ├── service/             # 서비스 계층
│   │   │   │   ├── UserService.java
│   │   │   │   ├── ProgramService.java
│   │   │   │   └── ...
│   │   │   ├── repository/          # 저장소 계층
│   │   │   │   ├── UserRepository.java
│   │   │   │   ├── ProgramRepository.java
│   │   │   │   └── ...
│   │   │   ├── entity/              # 엔티티 (도메인 모델)
│   │   │   │   ├── User.java
│   │   │   │   ├── Program.java
│   │   │   │   └── ...
│   │   │   ├── dto/                 # DTO
│   │   │   │   ├── request/
│   │   │   │   └── response/
│   │   │   ├── exception/           # 예외 처리
│   │   │   └── util/                # 유틸리티
│   │   └── resources/
│   │       ├── templates/           # Thymeleaf 템플릿
│   │       │   ├── layout/
│   │       │   ├── admin/
│   │       │   ├── student/
│   │       │   └── ...
│   │       ├── static/              # 정적 리소스
│   │       │   ├── css/
│   │       │   ├── js/
│   │       │   └── images/
│   │       └── application.yml      # 애플리케이션 설정
│   └── test/                        # 테스트 코드
├── database/                        # 데이터베이스 스크립트
│   └── schema.sql
├── doc/                             # 개발 문서
├── deliverables/                    # 산출물
└── build.gradle                     # 빌드 설정
```

---

## 13. 설계 원칙

### 13.1 SOLID 원칙 적용
- **S (Single Responsibility)**: 각 클래스는 단일 책임
- **O (Open/Closed)**: 확장에 열려있고 수정에 닫혀있음
- **L (Liskov Substitution)**: 하위 타입은 상위 타입을 대체 가능
- **I (Interface Segregation)**: 인터페이스 분리
- **D (Dependency Inversion)**: 추상화에 의존

### 13.2 DRY (Don't Repeat Yourself)
- 공통 로직은 BaseEntity, BaseController 등으로 추출
- 유틸리티 클래스 활용

### 13.3 관심사의 분리 (Separation of Concerns)
- 계층형 아키텍처로 각 계층의 책임 분리
- Entity와 DTO 분리

### 13.4 Convention over Configuration
- Spring Boot의 자동 설정 활용
- 표준 디렉토리 구조 준수

---

## 14. 제약사항 및 전제조건

### 14.1 시스템 제약사항
- JDK 17 이상 필수
- MySQL 8.0 이상 필수
- 최소 메모리: 2GB RAM
- 디스크 공간: 최소 10GB

### 14.2 네트워크 요구사항
- HTTP/HTTPS 프로토콜 지원
- 포트 8080 (애플리케이션)
- 포트 3306 (MySQL)

### 14.3 브라우저 지원
- Chrome 최신 버전
- Firefox 최신 버전
- Safari 최신 버전
- Edge 최신 버전

---

## 15. 향후 개선 계획

### 15.1 단기 계획 (3개월)
- [ ] 캐싱 적용 (Spring Cache)
- [ ] 검색 성능 개선 (Full-Text Search)
- [ ] 파일 스토리지 분리 (S3 등)

### 15.2 중기 계획 (6개월)
- [ ] Redis 세션 저장소 도입
- [ ] ElasticSearch 도입
- [ ] API 문서 자동화 (Swagger/OpenAPI)

### 15.3 장기 계획 (1년)
- [ ] 마이크로서비스 아키텍처 전환
- [ ] 실시간 알림 (WebSocket)
- [ ] 모바일 앱 개발 (React Native)

---

## 16. 참고 자료

### 16.1 관련 문서
- [데이터베이스 설계서](./02_데이터베이스설계서.md)
- [API 명세서](./03_API명세서.md)
- [프로젝트 개요](../../doc/development-logs/01_PROJECT_OVERVIEW.md)

### 16.2 외부 참조
- Spring Boot Documentation: https://spring.io/projects/spring-boot
- Spring Security Reference: https://spring.io/projects/spring-security
- Spring Data JPA Documentation: https://spring.io/projects/spring-data-jpa
- Thymeleaf Documentation: https://www.thymeleaf.org/

---

## 17. 버전 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2025-11-18 | 개발팀 | 최초 작성 |

---

**문서 작성일**: 2025-11-18
**최종 검토자**: 개발팀
**승인일**: 2025-11-18
